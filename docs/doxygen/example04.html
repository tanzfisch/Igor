<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.8.8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>Igor: 3D Rendering Example</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
		<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr>
						<td id="projectlogo">                        
                            <div style="position: relative; height: 120px; width: 440px;">
                                <div style="position: absolute; float: right; right: 30px; bottom: 10px; z-index: 1000; background-color: transparent;">0.22.0</div>
                                <img alt="Logo" src="logo.png"></img>                            
                            </div>
                        </td>                            
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('example04.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">3D Rendering Example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The 3D example shows how to load models and place them in to a 3D scene. It also introduces light, lod and switch nodes (<a href="https://www.youtube.com/watch?v=UQ7iFGFOv10">youtube</a>).</p>
<h1>Build </h1>
<p>The code for this example can be found in the folder examples/04 3D. In a vs[ver] sub folder you will find a visual studio solution which contains example project but also all dependent projects. So you just open this one and than build and start. If everything went right you gonna see the following screen. If not please don't hesitate to contact <a href="https://github.com/tanzfisch">tanzfisch</a>.</p>
<div class="image">
<img src="Example04_Pic1.png" alt="Example04_Pic1.png"/>
<div class="caption">
3D Rendering Example</div></div>
<p> There is also a short youtube clip <a href="https://www.youtube.com/watch?v=UQ7iFGFOv10">3D Example</a>.</p>
<h1>Interaction </h1>
<p>In this example we have some user inputs. Following a list.</p><ul>
<li>hold left mouse button and move to rotate the camera around the origin of the scene</li>
<li>hold right mouse button and move to rotate a group of models around the origin</li>
<li>use mouse wheel to change distance of camera to origin (so you can see the change in LOD)</li>
<li>press <b>Space</b> to toggle the switch node</li>
<li>press <b>F1</b> for print the current scene to the console</li>
<li>press <b>ESC</b> to quit</li>
</ul>
<h1>Code </h1>
<p>Let's start with initializing the scene inside the init method. <a class="el" href="namespace_igor.html">Igor</a> can handle multiple scenes but most of the time one is enough. In order to make Igot display a scene on screen we need to bind it to a view which was added to a window. </p><pre class="fragment">// init scene
_scene = iSceneFactory::getInstance().createScene();
// bind scene to perspective view
_view.setScene(_scene);
</pre><p>First thing we add to the scene is a camera. To position the camera somewhere else then in the origin it must be child of at least one transformation node. In <a class="el" href="namespace_igor.html">Igor</a> any combination of node types as children of other nodes is valid. </p><pre class="fragment">// setup camera
// we want a camera which can be rotated arround the origin
// we will acchive that with 3 transform nodes
// one is for the heading
iNodeTransform* cameraHeading = static_cast&lt;iNodeTransform*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeTransform));
// give the transform node a name. naming is optional and ist jus for helping to debug. 
// Names do not have to be unique but since it is possible to find nodes by name they better are
cameraHeading-&gt;setName("camera heading");
_cameraHeading = cameraHeading-&gt;getID();
// one is for the pitch
iNodeTransform* cameraPitch = static_cast&lt;iNodeTransform*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeTransform));
cameraPitch-&gt;setName("camera pitch");
_cameraPitch = cameraPitch-&gt;getID();
// and one is for translation or distance from the origin
iNodeTransform* cameraTranslation = static_cast&lt;iNodeTransform*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeTransform));
cameraTranslation-&gt;setName("camera translation");
// translate away from origin
cameraTranslation-&gt;translate(0, 0, 10);
_cameraTranslation = cameraTranslation-&gt;getID();
// from all nodes that we want to control later we save the node ID
// and last but not least we create a camera node
iNodeCamera* camera = static_cast&lt;iNodeCamera*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeCamera));
camera-&gt;setName("camera");
// and build everything together
// first we add the heading to the root node
_scene-&gt;getRoot()-&gt;insertNode(cameraHeading);
// than the pitch to the heading node
cameraHeading-&gt;insertNode(cameraPitch);
// then the translation to the pitch node
cameraPitch-&gt;insertNode(cameraTranslation);
// and than we add the camera to the translation
cameraTranslation-&gt;insertNode(camera);
// and finally we set the camera active. for this to work a camera must be part of a scene 
// wich we achived by adding all those nodes on to an other starting with the root node
camera-&gt;makeCurrent();
</pre><p>Only one camera per scene can be active at a time. If an other camera was active already it will be deactivated. Next we have a look at how to add a model node. </p><pre class="fragment">// create a single cat model
iNodeTransform* justCatTransform = static_cast&lt;iNodeTransform*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeTransform));
justCatTransform-&gt;setName("just a cat transform");
justCatTransform-&gt;translate(0, 1, 0);
// create a cat model
iNodeModel* justCatModel = static_cast&lt;iNodeModel*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeModel));
// Node model names can be altered but they also are generated based on the file name
justCatModel-&gt;setModel("cat.ompf");
// building the created nodes together and insert them in the scene
_scene-&gt;getRoot()-&gt;insertNode(justCatTransform);
justCatTransform-&gt;insertNode(justCatModel);
</pre><p>The *.ompf model will be located by <a class="el" href="namespace_igor.html">Igor</a> within the predefined search paths. Now we are going to take a look at the switch node. It is a node that can set on of it's children active while all the others are inactive. One scenario for this could be a model of a vehicle and a model of a vehicle that is broken or burned out. And when ever the vehicle is broken you can just flip the switch. In the example we add 3 nodes to the switch node. </p><pre class="fragment">// creating the switch node
iNodeSwitch* switchNode = static_cast&lt;iNodeSwitch*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeSwitch));
_switchNode = switchNode-&gt;getID();
// add the switch node to the all objects pitch / group
allObjectsPitch-&gt;insertNode(switchNode);
// than add the transform nodes to the switch node
switchNode-&gt;insertNode(crateTransform);
switchNode-&gt;insertNode(teapotTransform);
switchNode-&gt;insertNode(catTransform);
// set the current activated child
switchNode-&gt;setActiveChild("crate transform");
</pre><p>Similar to the switch node. Is the LOD switch node. Again it has multiple children and again it controls where a child is active or not. But this time it depends on the distance to an LOD trigger node which we attach in this case to the camera. </p><pre class="fragment">// creating the LOD switch node
iNodeLODSwitch* lodswitch = static_cast&lt;iNodeLODSwitch*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeLODSwitch));
// add it to the scene
allObjectsPitch-&gt;insertNode(lodswitch);
// and add the nodes to it
lodswitch-&gt;insertNode(lod0Transform);
lodswitch-&gt;insertNode(lod1Transform);
lodswitch-&gt;insertNode(lod2Transform);
// set up the nodes switch distances. the switch distances are allowed to have gaps or overlap
lodswitch-&gt;setThresholds(lod0Transform, 0.0f, 5.0f);
lodswitch-&gt;setThresholds(lod1Transform, 5.0f, 11.0f);
lodswitch-&gt;setThresholds(lod2Transform, 11.0f, 22.0f);
// in order to causing the LOD switch to change the active child node it needs to be triggered by a LOD trigger node
// creating the lod trigger node
iNodeLODTrigger* lodtrigger = static_cast&lt;iNodeLODTrigger*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeLODTrigger));
// bind the lod switch node with the lod trigger node
lodswitch-&gt;addTrigger(lodtrigger);
// and add the lod trigger to the scene by attaching it to the camera. there can be multiple LOD triggers and any lod switch can react on any lod trigger
camera-&gt;insertNode(lodtrigger);
</pre><p>Let's add also a sky box as background for better orientation. </p><pre class="fragment">// create a skybox
iNodeSkyBox* skyBoxNode = static_cast&lt;iNodeSkyBox*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeSkyBox));
// set it up with the default skybox texture
skyBoxNode-&gt;setTextures(
    "skybox_default/front.png",
    "skybox_default/back.png",
    "skybox_default/left.png",
    "skybox_default/right.png",
    "skybox_default/top.png",
    "skybox_default/bottom.png");
// manipulate the texture scale so we can see the repeating pattern of the textures
skyBoxNode-&gt;setTextureScale(10);
// create a material for the sky box because the default material for all iNodeRender and deriving classes has no textures and uses depth test
_materialSkyBox = iMaterialResourceFactory::getInstance().createMaterial();
iMaterialResourceFactory::getInstance().getMaterial(_materialSkyBox)-&gt;getRenderStateSet().setRenderState(iRenderState::DepthTest, iRenderStateValue::Off);
iMaterialResourceFactory::getInstance().getMaterial(_materialSkyBox)-&gt;getRenderStateSet().setRenderState(iRenderState::Texture2D0, iRenderStateValue::On);
iMaterialResourceFactory::getInstance().getMaterialGroup(_materialSkyBox)-&gt;setOrder(iMaterial::RENDER_ORDER_EARLY);
iMaterialResourceFactory::getInstance().getMaterialGroup(_materialSkyBox)-&gt;getMaterial()-&gt;setName("SkyBox");
// set that material
skyBoxNode-&gt;setMaterial(_materialSkyBox);
// and add it to the scene
_scene-&gt;getRoot()-&gt;insertNode(skyBoxNode);
</pre><p>And also switch the light on. </p><pre class="fragment">// setup light
// transform node for the lights orientation
iNodeTransform* directionalLightRotate = static_cast&lt;iNodeTransform*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeTransform));
// keep transform node id so we can manipulate the light's position later
_directionalLightRotate = directionalLightRotate-&gt;getID();
// transform node for the lights distance to the origin
iNodeTransform* directionalLightTranslate = static_cast&lt;iNodeTransform*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeTransform));
directionalLightTranslate-&gt;translate(100, 100, 100);
// the light node
iNodeLight* lightNode = static_cast&lt;iNodeLight*&gt;(iNodeFactory::getInstance().createNode(iNodeType::iNodeLight));
lightNode-&gt;setAmbient(iaColor4f(0.3f, 0.3f, 0.3f, 1.0f));
lightNode-&gt;setDiffuse(iaColor4f(0.8f, 0.8f, 0.8f, 1.0f));
lightNode-&gt;setSpecular(iaColor4f(1.0f, 1.0f, 1.0f, 1.0f));
// insert light to scene
_scene-&gt;getRoot()-&gt;insertNode(directionalLightRotate);
directionalLightRotate-&gt;insertNode(directionalLightTranslate);
directionalLightTranslate-&gt;insertNode(lightNode);
</pre><p>For Manipulating the transform nodes have a look at onMouseWheel and onMouseMoved. And that's it. For further questions please contact <a href="https://github.com/tanzfisch">tanzfisch</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>
				<li class="footer">
					Generated by <a href="http://www.doxygen.org/index.html">
					<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8.
					Dark theme by <a href="http://majerle.eu" target="_new">Tilen Majerle</a>. All rights reserved.
				</li>
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>